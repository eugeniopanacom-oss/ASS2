<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A.S. Studio - Barber√≠a Profesional</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
        /* Variables de tema oscuro */
        :root {
            --primary: #d4af37;
            --primary-dark: #b8941f;
            --dark: #121212;
            --darker: #0a0a0a;
            --light: #f5f5f5;
            --gray: #2a2a2a;
            --gray-light: #3a3a3a;
            --success: #4caf50;
            --error: #f44336;
            --border-radius: 8px;
            --transition: all 0.3s ease;
        }

        /* Reset y estilos base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--dark);
            color: var(--light);
            line-height: 1.6;
            min-height: 100vh;
            padding-bottom: 100px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header y navegaci√≥n */
        header {
            background-color: var(--darker);
            padding: 20px 0;
            border-bottom: 2px solid var(--primary);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .logo i {
            color: var(--primary);
            font-size: 2.5rem;
        }

        .logo h1 {
            font-size: 2.5rem;
            color: var(--primary);
            letter-spacing: 2px;
        }

        .tagline {
            text-align: center;
            color: #aaa;
            font-style: italic;
            margin-top: 5px;
        }

        /* Secciones generales */
        section {
            padding: 40px 0;
            border-bottom: 1px solid var(--gray);
        }

        .section-title {
            color: var(--primary);
            font-size: 1.8rem;
            margin-bottom: 25px;
            text-align: center;
            position: relative;
        }

        .section-title:after {
            content: '';
            display: block;
            width: 60px;
            height: 3px;
            background-color: var(--primary);
            margin: 10px auto;
        }

        /* Bienvenida */
        .welcome {
            text-align: center;
            padding: 60px 0;
            background: linear-gradient(rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.8)), url('https://images.unsplash.com/photo-1585747860715-2ba37e788b70?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1174&q=80') center/cover no-repeat;
            border-radius: var(--border-radius);
            margin: 30px 0;
        }

        .welcome h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: var(--primary);
        }

        .welcome p {
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto 30px;
            color: #ddd;
        }

        .btn {
            display: inline-block;
            background-color: var(--primary);
            color: var(--dark);
            padding: 12px 30px;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-weight: bold;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
        }

        .btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-3px);
        }

        /* Informaci√≥n de contacto */
        .info-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .info-card {
            background-color: var(--gray);
            padding: 25px;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--primary);
        }

        .info-card h3 {
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Calendario y horarios */
        .calendar-section {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            justify-content: space-between;
        }

        .calendar-container {
            flex: 1;
            min-width: 300px;
        }

        .hours-container {
            flex: 1;
            min-width: 300px;
            background-color: var(--gray);
            padding: 25px;
            border-radius: var(--border-radius);
        }

        .calendar {
            background-color: var(--gray);
            border-radius: var(--border-radius);
            overflow: hidden;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--primary);
            color: var(--dark);
            padding: 15px;
            font-weight: bold;
        }

        .calendar-days,
        .calendar-dates {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background-color: var(--gray-light);
        }

        .calendar-day {
            padding: 15px;
            text-align: center;
            background-color: var(--gray);
            font-weight: bold;
        }

        .calendar-date {
            padding: 15px;
            text-align: center;
            background-color: var(--gray);
            cursor: pointer;
            transition: var(--transition);
        }

        .calendar-date:hover {
            background-color: var(--gray-light);
        }

        .calendar-date.selected {
            background-color: var(--primary);
            color: var(--dark);
            font-weight: bold;
        }

        .calendar-date.disabled {
            background-color: var(--darker);
            color: #666;
            cursor: not-allowed;
        }

        .hours-list {
            margin-top: 20px;
        }

        .hour-option {
            display: inline-block;
            padding: 10px 15px;
            background-color: var(--dark);
            margin: 5px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid var(--gray-light);
        }

        .hour-option:hover {
            border-color: var(--primary);
        }

        .hour-option.selected {
            background-color: var(--primary);
            color: var(--dark);
            font-weight: bold;
        }

        .hour-option.disabled {
            background-color: var(--darker);
            color: #666;
            cursor: not-allowed;
            border-color: var(--darker);
        }

        /* Servicios y precios */
        .services {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .service-card {
            background-color: var(--gray);
            padding: 25px;
            border-radius: var(--border-radius);
            transition: var(--transition);
            border: 1px solid transparent;
        }

        .service-card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
        }

        .service-card.featured {
            border-color: var(--primary);
            position: relative;
            overflow: hidden;
        }

        .service-card.featured:before {
            content: 'OFERTA';
            position: absolute;
            top: 10px;
            right: -30px;
            background-color: var(--primary);
            color: var(--dark);
            padding: 5px 30px;
            transform: rotate(45deg);
            font-weight: bold;
            font-size: 0.8rem;
        }

        .service-name {
            color: var(--primary);
            font-size: 1.3rem;
            margin-bottom: 10px;
        }

        .service-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--light);
        }

        .service-price.old {
            text-decoration: line-through;
            color: #aaa;
            font-size: 1.2rem;
            margin-right: 10px;
        }

        /* Formulario de reserva */
        .reservation-form {
            background-color: var(--gray);
            padding: 30px;
            border-radius: var(--border-radius);
            max-width: 800px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--primary);
            font-weight: bold;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            background-color: var(--dark);
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            color: var(--light);
            font-size: 1rem;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .form-row .form-group {
            flex: 1;
            min-width: 250px;
        }

        .reservation-summary {
            background-color: var(--dark);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-top: 20px;
            border-left: 4px solid var(--primary);
        }

        /* Reportar problemas */
        .report-section {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--darker);
            padding: 15px;
            border-top: 1px solid var(--gray);
            z-index: 1000;
        }

        .report-toggle {
            background-color: var(--primary);
            color: var(--dark);
            border: none;
            padding: 10px 20px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 0 auto;
        }

        .report-form {
            max-width: 500px;
            margin: 20px auto 0;
            background-color: var(--gray);
            padding: 20px;
            border-radius: var(--border-radius);
            display: none;
        }

        .report-form.active {
            display: block;
        }

        .capture-btn {
            background-color: var(--dark);
            color: var(--light);
            border: 1px solid var(--gray-light);
            padding: 8px 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        /* Notificaciones */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: var(--border-radius);
            color: white;
            font-weight: bold;
            z-index: 10000;
            display: none;
            animation: slideIn 0.5s ease;
        }

        .notification.success {
            background-color: var(--success);
        }

        .notification.error {
            background-color: var(--error);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .logo h1 {
                font-size: 2rem;
            }

            .welcome h2 {
                font-size: 1.8rem;
            }

            .section-title {
                font-size: 1.5rem;
            }

            .calendar-section {
                flex-direction: column;
            }
        }
    </style>
</head>

<body>
    <!-- Header con logo -->
    <header>
        <div class="container">
            <div class="logo">
                <i class="fas fa-cut"></i>
                <h1>A.S. Studio</h1>
            </div>
            <p class="tagline">Barber√≠a profesional - Un √∫nico barbero, m√°xima atenci√≥n</p>
        </div>
    </header>

    <main class="container">
        <!-- Secci√≥n de bienvenida -->
        <section class="welcome">
            <h2>Bienvenido a A.S. Studio</h2>
            <p>Experimenta el arte de la barber√≠a tradicional con un toque moderno. Reserva tu turno para recibir un
                servicio personalizado de la m√°s alta calidad.</p>
            <button class="btn" id="scrollToReservation">
                <i class="fas fa-calendar-alt"></i> Reservar Turno
            </button>
        </section>

        <!-- Informaci√≥n de contacto -->
        <section id="info">
            <h2 class="section-title">Informaci√≥n de Contacto</h2>
            <div class="info-cards">
                <div class="info-card">
                    <h3><i class="fas fa-map-marker-alt"></i> Direcci√≥n</h3>
                    <p>Av. Principal 1234, Local 5<br>Barrio Centro, Ciudad</p>
                </div>
                <div class="info-card">
                    <h3><i class="fas fa-clock"></i> Horario de Atenci√≥n</h3>
                    <p>Lunes a Viernes: 9:00 - 19:00<br>S√°bados: 10:00 - 16:00<br>Domingos: Cerrado</p>
                </div>
                <div class="info-card">
                    <h3><i class="fas fa-phone-alt"></i> Contacto</h3>
                    <p>Tel: +54 11 1234-5678<br>WhatsApp: +54 11 8765-4321<br>Email: info@asstudio.com</p>
                </div>
            </div>
        </section>

        <!-- Calendario y horarios -->
        <section id="schedule">
            <h2 class="section-title">Selecciona Fecha y Hora</h2>
            <div class="calendar-section">
                <div class="calendar-container">
                    <div class="calendar">
                        <div class="calendar-header">
                            <button id="prevMonth"><i class="fas fa-chevron-left"></i></button>
                            <h3 id="currentMonth">Septiembre 2023</h3>
                            <button id="nextMonth"><i class="fas fa-chevron-right"></i></button>
                        </div>
                        <div class="calendar-days">
                            <div class="calendar-day">Dom</div>
                            <div class="calendar-day">Lun</div>
                            <div class="calendar-day">Mar</div>
                            <div class="calendar-day">Mi√©</div>
                            <div class="calendar-day">Jue</div>
                            <div class="calendar-day">Vie</div>
                            <div class="calendar-day">S√°b</div>
                        </div>
                        <div class="calendar-dates" id="calendarDates">
                            <!-- Los d√≠as se generar√°n con JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="hours-container">
                    <h3>Horarios disponibles</h3>
                    <p id="selectedDateText">Selecciona una fecha en el calendario</p>
                    <div class="hours-list" id="hoursList">
                        <!-- Los horarios se generar√°n con JavaScript -->
                    </div>
                    <div class="info-card" style="margin-top: 20px;">
                        <h3><i class="fas fa-info-circle"></i> Importante</h3>
                        <p>No se pueden reservar dos turnos en el mismo d√≠a y horario. Cada cita tiene una duraci√≥n
                            aproximada de 30-45 minutos.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Servicios y precios -->
        <section id="services">
            <h2 class="section-title">Servicios y Precios</h2>
            <div class="services">
                <div class="service-card">
                    <h3 class="service-name">Corte de Cabello</h3>
                    <p>Corte tradicional o moderno seg√∫n tu preferencia, con acabado profesional.</p>
                    <p class="service-price">$2.500</p>
                </div>
                <div class="service-card featured">
                    <h3 class="service-name">Corte + Barba</h3>
                    <p>Combo especial: corte de cabello m√°s arreglo de barba con acabado premium.</p>
                    <p>
                        <span class="service-price old">$4.000</span>
                        <span class="service-price">$3.200</span>
                    </p>
                </div>
                <div class="service-card">
                    <h3 class="service-name">Arreglo de Barba</h3>
                    <p>Modelado, recorte y acabado de barba con productos especializados.</p>
                    <p class="service-price">$1.800</p>
                </div>
                <div class="service-card">
                    <h3 class="service-name">Afeitado Cl√°sico</h3>
                    <p>Afeitado tradicional con navaja, toallas calientes y productos premium.</p>
                    <p class="service-price">$2.200</p>
                </div>
            </div>
        </section>

        <!-- Formulario de reserva -->
        <section id="reservation">
            <h2 class="section-title">Reserva tu Turno</h2>
            <div class="reservation-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="clientName">Nombre / Apodo *</label>
                        <input type="text" id="clientName" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="clientWhatsApp">N√∫mero de WhatsApp *</label>
                        <input type="tel" id="clientWhatsApp" class="form-control" placeholder="Ej: +54 11 1234 ‚Äî 5678">
                    </div>
                </div>

                <div class="form-group">
                    <label for="serviceSelect">Servicio *</label>
                    <select id="serviceSelect" class="form-control">
                        <option value="">Selecciona un servicio</option>
                        <option value="Corte de Cabello">Corte de Cabello - $2.500</option>
                        <option value="Corte + Barba">Corte + Barba - $3.200</option>
                        <option value="Arreglo de Barba">Arreglo de Barba - $1.800</option>
                        <option value="Afeitado Cl√°sico">Afeitado Cl√°sico - $2.200</option>
                    </select>
                </div>

                <div class="reservation-summary">
                    <h3>Resumen de tu Reserva</h3>
                    <p><strong>Fecha:</strong> <span id="summaryDate">No seleccionada</span></p>
                    <p><strong>Hora:</strong> <span id="summaryTime">No seleccionada</span></p>
                    <p><strong>Servicio:</strong> <span id="summaryService">No seleccionado</span></p>
                    <p><strong>Total:</strong> <span id="summaryPrice">$0</span></p>
                </div>

                <div class="form-group">
                    <p style="color: #aaa; font-size: 0.9rem; margin-top: 20px;">
                        * Al confirmar la reserva, recibir√°s un mensaje de WhatsApp con los detalles de tu turno.
                    </p>
                </div>

                <button class="btn" id="confirmReservation" style="width: 100%; padding: 15px; font-size: 1.1rem;">
                    <i class="fab fa-whatsapp"></i> Confirmar Reserva por WhatsApp
                </button>
            </div>
        </section>
    </main>

    <!-- Secci√≥n para reportar problemas -->
    <footer class="report-section">
        <button class="report-toggle" id="toggleReport">
            <i class="fas fa-exclamation-triangle"></i> Reportar un Problema
        </button>

        <div class="report-form" id="reportForm">
            <div class="form-group">
                <label for="problemDescription">Describe el problema *</label>
                <textarea id="problemDescription" class="form-control" rows="3"
                    placeholder="Detalla el problema que encontraste..."></textarea>
            </div>

            <button class="capture-btn" id="captureScreen">
                <i class="fas fa-camera"></i> Capturar Pantalla
            </button>

            <button class="btn" id="sendReport" style="margin-top: 15px; width: 100%;">
                <i class="fas fa-paper-plane"></i> Enviar Reporte
            </button>
        </div>
    </footer>

    <!-- Notificaci√≥n -->
    <div class="notification" id="notification"></div>

    <script>
        // Configuraci√≥n de Supabase (reemplaza con tus credenciales reales)
        const SUPABASE_URL = 'https://qbbpcjsvsecvxrddiead.supabase.co';
        const SUPABASE_ANON_KEY = 'sb_publishable_qAOO0wwyzIt5OAF3CC5j4w_GtzEXlJu';

        // Inicializar Supabase (comentado hasta que a√±adas tus credenciales)
        // const 
        // 
        supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Variables globales
        let selectedDate = null;
        let selectedTime = null;
        let selectedService = null;
        let bookedSlots = {}; // Para almacenar los turnos ya reservados

        // Datos de ejemplo de turnos reservados (en un caso real vendr√≠an de Supabase)
        const exampleBookedSlots = {
            '2023-09-15': ['09:00', '10:30', '14:00'],
            '2023-09-16': ['11:00', '15:30'],
            '2023-09-18': ['09:30', '13:00', '16:30']
        };

        // Precios de servicios
        const servicePrices = {
            'Corte de Cabello': 2500,
            'Corte + Barba': 3200,
            'Arreglo de Barba': 1800,
            'Afeitado Cl√°sico': 2200
        };

        // Inicializaci√≥n cuando el DOM est√© listo
        document.addEventListener('DOMContentLoaded', function () {
            // Inicializar calendario
            initCalendar();

            // Configurar eventos
            setupEventListeners();

            // Cargar turnos reservados (en un caso real desde Supabase)
            loadBookedSlots();
        });

        // Inicializar el calendario
        function initCalendar() {
            const now = new Date();
            currentMonth = now.getMonth();
            currentYear = now.getFullYear();

            renderCalendar(currentMonth, currentYear);
            updateAvailableHours();
        }

        // Renderizar el calendario
        function renderCalendar(month, year) {
            const monthNames = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio",
                "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];

            // Actualizar el encabezado del mes
            document.getElementById('currentMonth').textContent = `${monthNames[month]} ${year}`;

            // Obtener el primer d√≠a del mes
            const firstDay = new Date(year, month, 1);
            const startingDay = firstDay.getDay(); // 0 = Domingo, 1 = Lunes, etc.

            // Obtener el n√∫mero de d√≠as en el mes
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            // Limpiar el calendario
            const calendarDates = document.getElementById('calendarDates');
            calendarDates.innerHTML = '';

            // A√±adir d√≠as vac√≠os al principio si es necesario
            for (let i = 0; i < startingDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.classList.add('calendar-date', 'disabled');
                calendarDates.appendChild(emptyDay);
            }

            // A√±adir los d√≠as del mes
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const dateStr = formatDate(date);
                const dateElement = document.createElement('div');
                dateElement.classList.add('calendar-date');
                dateElement.textContent = day;
                dateElement.dataset.date = dateStr;

                // Deshabilitar d√≠as pasados
                if (date < today) {
                    dateElement.classList.add('disabled');
                } else {
                    // Marcar como seleccionado si es la fecha seleccionada
                    if (selectedDate === dateStr) {
                        dateElement.classList.add('selected');
                    }

                    dateElement.addEventListener('click', function () {
                        selectDate(dateStr);
                    });
                }

                calendarDates.appendChild(dateElement);
            }
        }

        // Configurar escuchadores de eventos
        function setupEventListeners() {
            // Navegaci√≥n del calendario
            document.getElementById('prevMonth').addEventListener('click', function () {
                currentMonth--;
                if (currentMonth < 0) {
                    currentMonth = 11;
                    currentYear--;
                }
                renderCalendar(currentMonth, currentYear);
            });

            document.getElementById('nextMonth').addEventListener('click', function () {
                currentMonth++;
                if (currentMonth > 11) {
                    currentMonth = 0;
                    currentYear++;
                }
                renderCalendar(currentMonth, currentYear);
            });

            // Selecci√≥n de servicio
            document.getElementById('serviceSelect').addEventListener('change', function () {
                selectedService = this.value;
                updateReservationSummary();
            });

            // Confirmar reserva
            document.getElementById('confirmReservation').addEventListener('click', confirmReservation);

            // Scroll a reserva
            document.getElementById('scrollToReservation').addEventListener('click', function () {
                document.getElementById('reservation').scrollIntoView({ behavior: 'smooth' });
            });

            // Reportar problemas
            document.getElementById('toggleReport').addEventListener('click', function () {
                document.getElementById('reportForm').classList.toggle('active');
            });

            document.getElementById('sendReport').addEventListener('click', sendReport);

            document.getElementById('captureScreen').addEventListener('click', function () {
                showNotification('La captura de pantalla se simula en este demo. En una aplicaci√≥n real, se usar√≠a una API como html2canvas.', 'info');
            });
        }

        // Cargar turnos reservados (simulaci√≥n)
        // Cargar turnos reservados desde Supabase
        async function loadBookedSlots() {
            try {
                // Obtener reservas de los pr√≥ximos 60 d√≠as
                const hoy = new Date();
                const futuro = new Date();
                futuro.setDate(hoy.getDate() + 60);

                const { data, error } = await supabase
                    .from('turnos')
                    .select('fecha, hora')
                    .gte('fecha', hoy.toISOString().split('T')[0])
                    .lte('fecha', futuro.toISOString().split('T')[0])
                    .eq('estado', 'confirmado');

                if (error) {
                    console.error('Error cargando reservas:', error);
                    // Usar datos de ejemplo como respaldo
                    bookedSlots = exampleBookedSlots;
                    return;
                }

                // Organizar datos por fecha
                bookedSlots = {};
                data.forEach(reserva => {
                    const fecha = reserva.fecha;
                    const hora = reserva.hora.substring(0, 5); // Formato HH:MM

                    if (!bookedSlots[fecha]) {
                        bookedSlots[fecha] = [];
                    }

                    if (!bookedSlots[fecha].includes(hora)) {
                        bookedSlots[fecha].push(hora);
                    }
                });

                console.log('Turnos reservados cargados:', bookedSlots);

            } catch (error) {
                console.error('Error:', error);
                bookedSlots = exampleBookedSlots;
            }
        }

        // Seleccionar fecha
        function selectDate(dateStr) {
            selectedDate = dateStr;

            // Actualizar visualizaci√≥n del calendario
            document.querySelectorAll('.calendar-date').forEach(el => {
                el.classList.remove('selected');
                if (el.dataset.date === dateStr) {
                    el.classList.add('selected');
                }
            });

            // Actualizar texto de fecha seleccionada
            const dateObj = parseDate(dateStr);
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('selectedDateText').textContent =
                `Turnos disponibles para el ${dateObj.toLocaleDateString('es-ES', options)}`;

            // Actualizar horas disponibles
            updateAvailableHours();
            updateReservationSummary();
        }

        // Seleccionar hora
        function selectTime(timeStr) {
            selectedTime = timeStr;

            // Actualizar visualizaci√≥n de horas
            document.querySelectorAll('.hour-option').forEach(el => {
                el.classList.remove('selected');
                if (el.dataset.time === timeStr) {
                    el.classList.add('selected');
                }
            });

            updateReservationSummary();
        }

        // Actualizar horas disponibles
        function updateAvailableHours() {
            const hoursList = document.getElementById('hoursList');
            hoursList.innerHTML = '';

            if (!selectedDate) {
                hoursList.innerHTML = '<p>Selecciona una fecha para ver los horarios disponibles</p>';
                return;
            }

            // Generar horarios de 9:00 a 18:30 cada 30 minutos
            const startHour = 9;
            const endHour = 18;
            const bookedForDate = bookedSlots[selectedDate] || [];

            for (let hour = startHour; hour <= endHour; hour++) {
                for (let minute = 0; minute < 60; minute += 30) {
                    // No mostrar despu√©s de las 18:00 los s√°bados
                    const dateObj = parseDate(selectedDate);
                    const isSaturday = dateObj.getDay() === 6;
                    if (isSaturday && hour >= 16 && minute > 0) break;

                    const timeStr = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                    const isBooked = bookedForDate.includes(timeStr);

                    const timeElement = document.createElement('div');
                    timeElement.classList.add('hour-option');
                    timeElement.dataset.time = timeStr;
                    timeElement.textContent = timeStr;

                    if (isBooked) {
                        timeElement.classList.add('disabled');
                        timeElement.title = 'Este horario ya est√° reservado';
                    } else {
                        timeElement.addEventListener('click', function () {
                            if (!this.classList.contains('disabled')) {
                                selectTime(timeStr);
                            }
                        });
                    }

                    hoursList.appendChild(timeElement);
                }
            }

            if (hoursList.children.length === 0) {
                hoursList.innerHTML = '<p>No hay horarios disponibles para esta fecha</p>';
            }
        }

        // Actualizar resumen de la reserva
        function updateReservationSummary() {
            document.getElementById('summaryDate').textContent = selectedDate
                ? formatDateForDisplay(parseDate(selectedDate))
                : 'No seleccionada';

            document.getElementById('summaryTime').textContent = selectedTime || 'No seleccionada';
            document.getElementById('summaryService').textContent = selectedService || 'No seleccionado';

            // Calcular precio
            let price = 0;
            if (selectedService && servicePrices[selectedService]) {
                price = servicePrices[selectedService];
            }

            document.getElementById('summaryPrice').textContent = `$${price.toLocaleString('es-AR')}`;
        }

        // Confirmar reserva
        // Confirmar reserva
        async function confirmReservation() {
            // Validar datos
            const clientName = document.getElementById('clientName').value.trim();
            const clientWhatsApp = document.getElementById('clientWhatsApp').value.trim();

            if (!clientName || !clientWhatsApp) {
                showNotification('Por favor, completa tu nombre y n√∫mero de WhatsApp', 'error');
                return;
            }

            if (!selectedDate || !selectedTime) {
                showNotification('Por favor, selecciona una fecha y hora para tu turno', 'error');
                return;
            }

            if (!selectedService) {
                showNotification('Por favor, selecciona un servicio', 'error');
                return;
            }

            // Verificar que el turno no est√© ya reservado
            const bookedForDate = bookedSlots[selectedDate] || [];
            if (bookedForDate.includes(selectedTime)) {
                showNotification('Lo sentimos, este horario ya ha sido reservado. Por favor, selecciona otro.', 'error');
                updateAvailableHours();
                return;
            }

            // üî¥ REEMPLAZA ESTA PARTE CON EL C√ìDIGO REAL:

            try {
                // 1. Guardar en Supabase
                const precio = servicePrices[selectedService];

                const { data, error } = await supabase
                    .from('turnos')
                    .insert([
                        {
                            fecha: selectedDate,
                            hora: selectedTime,
                            servicio: selectedService,
                            cliente: clientName,
                            whatsapp: clientWhatsApp,
                            precio: precio,
                            estado: 'confirmado'
                        }
                    ])
                    .select();

                if (error) {
                    console.error('Error Supabase:', error);

                    // Si es error de duplicado
                    if (error.code === '23505') {
                        showNotification('Este horario ya fue reservado por otra persona. Por favor, selecciona otro horario.', 'error');
                        // Actualizar la lista de reservados
                        await loadBookedSlots();
                        updateAvailableHours();
                        return;
                    }

                    showNotification('Error al guardar la reserva: ' + error.message, 'error');
                    return;
                }

                // En la funci√≥n confirmReservation, despu√©s de guardar en Supabase:

                // 2. Preparar mensaje que el CLIENTE enviar√° al BARBERO
                const formattedDate = formatDateForDisplay(parseDate(selectedDate));
                const price = servicePrices[selectedService];

                // üéØ REEMPLAZA CON TU N√öMERO REAL (DEL BARBERO)
                const NUMERO_BARBERO = '5491155739203'; // ‚Üê TU N√öMERO AQU√ç

                // Mensaje que el CLIENTE enviar√° al BARBERO
                const mensajeParaBarbero = `‚úÖ Confirmaci√≥n de Reserva - A.S. Studio

Hola, soy ${clientName} (WhatsApp: ${clientWhatsApp}).

Confirmo mi reserva para:

üìÖ Fecha: ${formattedDate}
‚è∞ Hora: ${selectedTime}
‚úÇÔ∏è Servicio: ${selectedService}
üí∞ Total: $${price.toLocaleString('es-AR')}

Por favor, conf√≠rmame la disponibilidad.
¬°Gracias!`;

                // 3. Mostrar panel especial para el CLIENTE
                showNotification('‚úÖ Reserva guardada. Ahora env√≠a confirmaci√≥n al barbero...', 'success');

                setTimeout(() => {
                    // Crear panel de instrucciones para el CLIENTE
                    const clientePanel = `
        <div style="
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1a1a1a;
            border: 3px solid #25D366;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            z-index: 10000;
            box-shadow: 0 10px 30px rgba(0,0,0,0.7);
            text-align: center;
        ">
            <h2 style="color:#25D366; margin-top:0;">
                <i class="fab fa-whatsapp"></i> √öltimo Paso
            </h2>
            
            <div style="background:#2a2a2a; padding:20px; border-radius:10px; margin:20px 0;">
                <p style="color:#fff; font-size:18px;">
                    <strong>¬°Reserva casi lista!</strong>
                </p>
                <p style="color:#ddd;">
                    Ahora env√≠a la confirmaci√≥n al barbero por WhatsApp
                </p>
                
                <div style="background:#1a1a1a; padding:15px; border-radius:8px; margin:15px 0; text-align:left;">
                    <p><strong>üë§ T√∫:</strong> ${clientName}</p>
                    <p><strong>üì± Tu WhatsApp:</strong> ${clientWhatsApp}</p>
                    <p><strong>üìÖ Fecha:</strong> ${formattedDate}</p>
                    <p><strong>‚è∞ Hora:</strong> ${selectedTime}</p>
                    <p><strong>‚úÇÔ∏è Servicio:</strong> ${selectedService}</p>
                    <p><strong>üí∞ Total:</strong> $${price.toLocaleString('es-AR')}</p>
                </div>
                
                <p style="color:#d4af37; font-size:14px;">
                    <i class="fas fa-info-circle"></i>
                    El barbero te confirmar√° la disponibilidad por WhatsApp
                </p>
            </div>
            
            <div style="display:flex; flex-direction:column; gap:15px; margin-top:20px;">
                <button id="enviarConfirmacionBtn" style="
                    background: #25D366;
                    color: white;
                    border: none;
                    padding: 15px 30px;
                    border-radius: 10px;
                    cursor: pointer;
                    font-weight: bold;
                    font-size: 18px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 15px;
                ">
                    <i class="fab fa-whatsapp"></i> Enviar Confirmaci√≥n al Barbero
                </button>
                
                <div style="color:#aaa; font-size:14px; display:flex; align-items:center; justify-content:center; gap:10px;">
                    <i class="fas fa-phone-alt"></i>
                    <span>Barbero: +${NUMERO_BARBERO.replace(/(\d{2})(\d{2})(\d{4})(\d{4})/, '$1 $2 $3 $4')}</span>
                </div>
                
                <button id="copiarMensajeBtn" style="
                    background: #d4af37;
                    color: black;
                    border: none;
                    padding: 12px 25px;
                    border-radius: 8px;
                    cursor: pointer;
                    font-weight: bold;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 10px;
                ">
                    <i class="fas fa-copy"></i> Copiar Mensaje
                </button>
                
                <button id="cerrarPanelClienteBtn" style="
                    background: #666;
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 8px;
                    cursor: pointer;
                ">
                    Cerrar (Ya envi√© el mensaje)
                </button>
            </div>
        </div>
        <div style="
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.9);
            z-index: 9999;
        " id="overlayCliente"></div>
    `;

                    // Agregar el panel al DOM
                    const div = document.createElement('div');
                    div.innerHTML = clientePanel;
                    document.body.appendChild(div.firstElementChild);

                    // Configurar botones
                    document.getElementById('enviarConfirmacionBtn').onclick = function () {
                        // Crear enlace de WhatsApp para que el CLIENTE env√≠e al BARBERO
                        const whatsappLink = `https://wa.me/${NUMERO_BARBERO}?text=${encodeURIComponent(mensajeParaBarbero)}`;

                        // Abrir WhatsApp (el cliente env√≠a al barbero)
                        window.open(whatsappLink, '_blank');

                        // Cambiar estado del bot√≥n
                        this.innerHTML = '<i class="fas fa-check"></i> WhatsApp Abierto';
                        this.style.background = '#128C7E';
                        this.disabled = true;

                        // Mostrar instrucciones
                        showNotification('WhatsApp abierto. Ahora env√≠a el mensaje al barbero.', 'info');

                        // Actualizar estado en Supabase (opcional)
                        actualizarEstadoReserva(data[0].id, 'pendiente_confirmacion');
                    };

                    document.getElementById('copiarMensajeBtn').onclick = function () {
                        // Copiar el mensaje al portapapeles
                        navigator.clipboard.writeText(mensajeParaBarbero).then(() => {
                            this.innerHTML = '<i class="fas fa-check"></i> Mensaje Copiado';
                            this.style.background = '#4CAF50';
                            this.style.color = 'white';

                            // Mostrar ayuda
                            alert('Mensaje copiado. Ahora:\n1. Abre WhatsApp manualmente\n2. Busca al barbero\n3. Pega y env√≠a el mensaje');

                            setTimeout(() => {
                                this.innerHTML = '<i class="fas fa-copy"></i> Copiar Mensaje';
                                this.style.background = '#d4af37';
                                this.style.color = 'black';
                            }, 3000);
                        });
                    };

                    document.getElementById('cerrarPanelClienteBtn').addEventListener('click', function () {
                        // Remover elementos
                        const overlay = document.getElementById('overlayCliente');
                        const panel = this.closest('div[style*="position: fixed"]');

                        if (overlay) overlay.remove();
                        if (panel) panel.remove();

                        resetForm();
                        showNotification('¬°Gracias! El barbero te confirmar√° pronto por WhatsApp.', 'success');
                    });

                    // Cerrar al hacer clic en el overlay
                    document.getElementById('overlayCliente').onclick = function () {
                        this.remove();
                        div.firstElementChild.remove();
                        resetForm();
                    };

                }, 1000);
                // 6. Limpiar formulario
                setTimeout(() => {
                    resetForm();
                }, 3000);

            } catch (error) {
                console.error('Error general:', error);
                showNotification('Error inesperado. Por favor, intenta nuevamente.', 'error');
            }
        }
        // Funci√≥n para actualizar estado de la reserva
        async function actualizarEstadoReserva(idReserva, nuevoEstado) {
            try {
                const { error } = await supabase
                    .from('turnos')
                    .update({ estado: nuevoEstado })
                    .eq('id', idReserva);

                if (error) {
                    console.error('Error actualizando estado:', error);
                } else {
                    console.log(`Estado actualizado a: ${nuevoEstado}`);
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }

        // Enviar reporte de problema
        function sendReport() {
            const problemDescription = document.getElementById('problemDescription').value.trim();

            if (!problemDescription) {
                showNotification('Por favor, describe el problema', 'error');
                return;
            }

            // Aqu√≠ en un caso real enviar√≠amos el reporte a Supabase
            // const { data, error } = await supabase
            //     .from('reportes_problemas')
            //     .insert([
            //         { 
            //             descripcion: problemDescription,
            //             fecha: new Date().toISOString().split('T')[0],
            //             captura: 'base64_image_data' // Si se implementa captura de pantalla
            //         }
            //     ]);

            showNotification('Reporte enviado. ¬°Gracias por ayudarnos a mejorar!', 'success');
            document.getElementById('problemDescription').value = '';
            document.getElementById('reportForm').classList.remove('active');
        }

        // Mostrar notificaci√≥n
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';

            setTimeout(() => {
                notification.style.display = 'none';
            }, 5000);
        }

        // Enviar reporte de problema a Supabase
        async function sendReport() {
            const problemDescription = document.getElementById('problemDescription').value.trim();

            if (!problemDescription) {
                showNotification('Por favor, describe el problema', 'error');
                return;
            }

            try {
                const { data, error } = await supabase
                    .from('reportes_problemas')  // Necesitas crear esta tabla
                    .insert([
                        {
                            descripcion: problemDescription,
                            fecha: new Date().toISOString().split('T')[0],
                            hora: new Date().toLocaleTimeString('es-AR', { hour12: false }),
                            ip: await getClientIP(), // Funci√≥n opcional
                            navegador: navigator.userAgent
                        }
                    ]);

                if (error) {
                    console.error('Error guardando reporte:', error);
                    showNotification('Error al enviar el reporte', 'error');
                    return;
                }

                showNotification('Reporte enviado. ¬°Gracias por ayudarnos a mejorar!', 'success');
                document.getElementById('problemDescription').value = '';
                document.getElementById('reportForm').classList.remove('active');

            } catch (error) {
                console.error('Error:', error);
                showNotification('Error al enviar el reporte', 'error');
            }
        }
        // Resetear formulario
        function resetForm() {
            selectedDate = null;
            selectedTime = null;
            selectedService = null;

            document.getElementById('clientName').value = '';
            document.getElementById('clientWhatsApp').value = '';
            document.getElementById('serviceSelect').value = '';

            // Limpiar selecciones visuales
            document.querySelectorAll('.calendar-date.selected').forEach(el => {
                el.classList.remove('selected');
            });

            document.querySelectorAll('.hour-option.selected').forEach(el => {
                el.classList.remove('selected');
            });

            updateReservationSummary();
            updateAvailableHours();
        }

        // Funciones auxiliares de formato de fecha
        function formatDate(date) {
            return date.toISOString().split('T')[0];
        }

        function parseDate(dateStr) {
            const [year, month, day] = dateStr.split('-').map(Number);
            return new Date(year, month - 1, day);
        }

        function formatDateForDisplay(date) {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            return date.toLocaleDateString('es-ES', options);
        }

        // Variables para el calendario
        let currentMonth, currentYear;
    </script>
</body>

</html>
